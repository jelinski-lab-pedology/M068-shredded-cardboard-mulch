---
title: "Soil climate analysis"
author: "Jennifer Nicklay"
---

## Packages

```{r}
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(here)
library(weathermetrics) #specifically for the temp units conversion
library(MASS) #boxcox transformation
library(lme4)         #mixed models
library(lmerTest)     #mixed models
library(broom.mixed)  #mixed models
library(emmeans)
library(moments)
library(RColorBrewer)
library(FSA)

```

## Loading Data
```{r}
soil_temp <- read.csv(here::here("00-data", "b-prepared", 
                                 "20250530_SCM-soil-temp.csv"), 
                      header = TRUE)

soil_vwc <- read.csv(here::here("00-data", "b-prepared", 
                                 "20250712_SCM-soil-moisture.csv"), 
                     header = TRUE)

soil_vwc_rt <- read.csv(here::here("00-data", "b-prepared", 
                                 "20250530_SCM-real time moisture-2023.csv"), 
                        header = TRUE)

drip_irrigation <- read.csv(here::here("00-data", "b-prepared", 
                                 "20250618_SCM-irrigation.csv"), header = TRUE)

temp_precip <- read.csv(here::here("00-data", "b-prepared", 
                                 "20250618_temp and precip.csv"), header = TRUE)
```

## Format Data

### Soil temperature
```{r}

soil_temp <- soil_temp %>%
             dplyr::select('ID', 'block','plot', 'treatment', 
                           'crop', 'date.time', 'temp_C') %>%
             mutate_at(c('ID', 'block', 'plot', 'treatment', 'crop'), as.factor) %>%
             mutate(date.time = lubridate::as_datetime(date.time, 
                                                       format = "%m/%d/%Y %H:%M:%S")) %>%
             mutate(date = lubridate::date(date.time)) %>%
             mutate(year = lubridate::isoyear(ymd_hms(date.time))) %>%
             mutate(week = lubridate::isoweek(ymd_hms(date.time))) %>%
             mutate(month = lubridate::month(date.time)) %>%
             mutate(study_yr = ifelse(year == "2023",1,
                                ifelse(year == "2024" & month < 5,1,
                                 2)))

#data frame for the min, max, and average soil temp each day for each temp probe
soil_temp_day <- soil_temp %>%
                 mutate(temp_C = ifelse(year == "2024" & ID == "20351017" & month > 4 & month < 7, NA , temp_C)) %>% 
                 group_by(ID, block, plot, treatment, crop, year, study_yr, month, week, date) %>%
                 summarize(day_max = max(temp_C, na.rm = TRUE),
                           day_min = min(temp_C, na.rm = TRUE),
                           day_avg = (day_max + day_min)/2, 
                           tmp_dif = day_max - day_min) %>%
                 ungroup() 
              
#average max, min, and mean soil temp for the day for each treatment
soil_temp_trt <- soil_temp_day %>%
                 group_by(treatment, year, week, month, study_yr, date) %>%
                 summarize(trt_avg_max = mean(day_max, na.rm = TRUE),
                           trt_avg_min = mean(day_min, na.rm = TRUE),
                           trt_avg = (trt_avg_max + trt_avg_min)/2,
                           trt_dif = trt_avg_max - trt_avg_min) %>%
                 ungroup()

# ALERT: there's a weird quirk in the first and last days of the year, where they are part of the week from a different year. So that's worth checking, either to see if there's a better function or to just remove those weirdo dates from the calculation
soil_temp_wk <- soil_temp_day %>%
                group_by(treatment, year, study_yr, week) %>%
                summarize(wk_avg_max = mean(day_max, na.rm = TRUE),
                          wk_avg_min = mean(day_min, na.rm = TRUE),
                          wk_avg = (wk_avg_max + wk_avg_min) /2) %>%
                ungroup()

#min, max, and average soil temp for each month
soil_temp_month <- soil_temp_day %>%
                   group_by(treatment, year, study_yr, month) %>%
                   summarize(count = n(),
                             mon_avg_min = mean(day_min, na.rm = TRUE),
                             mon_avg_max = mean(day_max, na.rm = TRUE),
                             mon_avg = (mon_avg_max + mon_avg_min) / 2) %>%
                   ungroup()

#write.csv(soil_temp_month, here::here("20250815_SCM_soil_temp.csv"), row.names=TRUE)

#min, max, and average soil temp for May through October
soil_temp_season <- soil_temp_day %>%
                    subset(month > 4 & month < 11) %>%
                    group_by(treatment, year, study_yr) %>%
                    summarize(season_avg_max = mean(day_max, na.rm = TRUE),
                              season_avg_min = mean(day_min, na.rm = TRUE),
                              season_avg = (season_avg_max + season_avg_min) / 2) %>%
                    ungroup()
```
### Air temperature 
```{r}

#check with Nic to see if changing trace precip to 0.001 in was appropriate
#creating month and week columns, limiting dataset to the years I'm interested in, changing units from standard to metric
temp_precip_day <- temp_precip %>%
                   rename(max_temp_F = Maximum.Temperature.degrees..F.,
                          min_temp_F = Minimum.Temperature.degrees..F.,
                          precip_in = Precipitation..inches.,
                          date = Date) %>%
                   mutate(date = lubridate::as_date(date, format = "%Y-%m-%d"),
                          year = as.numeric(lubridate::year(date))) %>%
                   mutate(month = lubridate::month(date),
                          week = lubridate::isoweek(ymd(date)), 
                          precip_in = ifelse(precip_in == "T", 0.001, precip_in)) %>%
                   subset(year == "2023" | year == "2024" | (year == "2025" & month < 5)) %>%
                   mutate_at(c('max_temp_F', 'min_temp_F','precip_in'), as.numeric) %>%
                   mutate(max_temp_C = fahrenheit.to.celsius(max_temp_F, round = 2),
                          min_temp_C = fahrenheit.to.celsius(min_temp_F, round = 2),
                          precip_mm = convert_precip(precip_in, old_metric = "inches", new_metric = "mm", round = 2),
                          avg_temp_C = (max_temp_C + min_temp_C)/2) %>%
                   dplyr::select('date', 'year', 'month', 'week', 'max_temp_C', 'min_temp_C', 'avg_temp_C','precip_in', 'precip_mm') 

# ALERT: there's a weird quirk in the first and last days of the year, where they are part of the week from a different year. So that's worth checking, either to see if there's a better function or to just remove those weirdo dates from the calculation  
temp_wk <- temp_precip_day %>%
           group_by(year, month, week) %>%
           summarize(wk_avg_temp_max = mean(max_temp_C, na.rm = TRUE),
                     wk_avg_temp_min = mean(min_temp_C, na.rm = TRUE),
                     wk_avg_temp_C = (wk_avg_temp_max + wk_avg_temp_min) /2) %>%
           ungroup()

#mean for the max, min, and average daily air temps each month
temp_mon <- temp_precip_day %>%
            group_by(year, month) %>%
            summarize(mon_avg_temp_max = mean(max_temp_C, na.rm = TRUE),
                      mon_avg_temp_min = mean(min_temp_C, na.rm = TRUE),
                      mon_avg_temp_C = (mon_avg_temp_max + mon_avg_temp_min) / 2) %>%
            ungroup()

#mean for the max, min, and average daily air temps across the whole season
temp_season <- temp_precip_day %>%
               subset(month > 4 & month < 11) %>%
               group_by(year) %>%
               summarize(season_avg_temp_max = mean(max_temp_C, na.rm = TRUE),
                         season_avg_temp_min = mean(min_temp_C, na.rm = TRUE),
                         season_avg_temp_C = (season_avg_temp_max + season_avg_temp_min) / 2) %>%
               ungroup()

#mean for the max, min, and average daily air temp across the whole year
temp_yr <- temp_precip_day %>%
           group_by(year) %>%
           summarize(yr_avg_temp_max = mean(max_temp_C, na.rm = TRUE),
                     yr_avg_temp_min = mean(min_temp_C, na.rm = TRUE),
                     yr_avg_temp_C = (yr_avg_temp_max + yr_avg_temp_min) / 2) %>%
           ungroup()
```
### Irrigation and Precipitation

```{r}
#creating columns for different time markers and for the type of irrigation
drip_irrigation <- drip_irrigation %>%
                   mutate(date = lubridate::as_date(date, format = "%m/%d/%Y"),
                          year = lubridate::isoyear(ymd(date)), 
                          month = lubridate::month(date),
                          week = lubridate::isoweek(ymd(date)),
                          irrigation_mm = convert_precip(irrigation_in, 
                                                         old_metric = "inches", 
                                                         new_metric = "mm", 
                                                         round = 2),
                          type = "drip") %>%
                   dplyr::select('date', 'year', 'month', 'week', 'type', 'irrigation_mm')

#combining precipitation and drip irrigation into a single table
irrigation_day <- temp_precip_day %>%
                  mutate(type = "precip") %>%
                  rename(irrigation_mm = precip_mm) %>%
                  dplyr::select('date','year','month','week','type','irrigation_mm') %>%
                  rbind(drip_irrigation)

#total water input by type each week
irrigation_wk <- irrigation_day %>%
                 group_by(year, month, week, type) %>%
                 summarize(irrigation_mm = sum(irrigation_mm)) %>%
                 ungroup()

#total water input by type each month
irrigation_mon <- irrigation_day %>%
                  group_by(year, month, type) %>%
                  summarize(irrigation_mm = sum(irrigation_mm)) %>%
                  ungroup()

#total water input by type for May through October
irrigation_season <- irrigation_day %>%
                     subset(month > 4 & month < 11) %>%
                     group_by(year, type) %>%
                     summarize(irrigation_mm = sum(irrigation_mm)) %>%
                     ungroup()

#total water input by type for the whole year
irrigation_yr <- irrigation_day %>%
                 group_by(year, type) %>%
                 summarize(irrigation_mm = sum(irrigation_mm)) %>%
                 ungroup()

```


### Soil Moisture
```{r}
#formatting data frame for soil moisture data from TDR


soil_vwc_full <- soil_vwc %>%
            subset(block != "5") %>%
            dplyr::select('sample_date', 'block','plot', 'treatment', 'crop', 
                          'bed_location', 'vwc_percent', 'period', 'EC')  %>%
            mutate(sample_date = lubridate::as_date(sample_date, 
                                                    format = "%m/%d/%Y"),
                   year = lubridate::isoyear(ymd(sample_date)),
                   month = lubridate::month(sample_date),
                   week = lubridate::isoweek(ymd(sample_date)),
                   bed_location = ifelse(bed_location == "hose", "center", bed_location)) %>%
            mutate_at(c('year', 'block', 'plot', 'treatment', 'crop', 'bed_location'), 
                      as.factor) 

#this data frame is only the measurements taken the day mulch was applied in 2023
soil_vwc_pre <- soil_vwc_full %>%
                subset(sample_date < "2023-06-23")

#this data frame excludes the measurments taken the day mulch was applied in 2023
soil_vwc <- soil_vwc_full %>%
            subset(sample_date > "2023-06-23")

#formatting data frame from continuous logger
soil_vwc_rt <- soil_vwc_rt %>%
               mutate(date.time = lubridate::as_datetime(date.time,
                                                         format = "%m/%d/%Y %H:%M")) %>%
               mutate(date = lubridate::date(date.time)) %>%
               mutate(month = lubridate::month(date.time)) %>%
               rename(BM = bare.soil,
                      CM = cardboard.mulch) %>%
               pivot_longer(cols = c('BM', 'CM'),
                            names_to = 'treatment',
                            values_to = "vwc_percent") %>%
               mutate(vwc_percent = as.numeric(gsub('%', '', vwc_percent)),
                      vwc_percent = ifelse(vwc_percent == 0, NA, vwc_percent)) %>%
               drop_na(vwc_percent) %>%
               subset(date != "2023-10-04") %>%
               mutate_at('treatment' ,as.factor)

```



####  Identifying outliers
```{r}
#There are three samples where the soil moisture is is 64.8%. All of them are much higher than the other samples for that plot during the same week. I removed these as outliers.

hist(soil_vwc$vwc_percent)

out_vwc <- subset(soil_vwc, vwc_percent > 50)

soil_vwc$vwc_percent[soil_vwc$vwc_percent > 50] <- NA

hist(soil_vwc$vwc_percent)
```



#### summary tables
```{r}
#average soil moisture by treatment, crop, plot, edge/center, and date
soil_vwc_wk <- soil_vwc %>%
               group_by(treatment, crop, block, plot, bed_location, sample_date, week, month, year) %>%
               summarize(vwc_avg_wk = mean(vwc_percent, na.rm = TRUE)) %>%
               ungroup()

#calculating the average soil moisture by treatment, crop, edge/center, and date
soil_vwc_wk_trt_crop <- soil_vwc %>%
                        group_by(treatment, crop, bed_location, sample_date, week, month, year) %>%
                        summarize(vwc_trt_avg_wk = mean(vwc_percent, na.rm = TRUE)) %>%
                        ungroup()

#average soil moisture by treatment, edge/center, and date (combines crops)
soil_vwc_wk_trt <- soil_vwc %>%
                   group_by(treatment, bed_location, sample_date, week, month, year) %>%
                   summarize(vwc_per_wk = mean(vwc_percent, na.rm = TRUE)) %>%
                   ungroup()

soil_vwc_wk_trt_full <- soil_vwc %>%
                   group_by(treatment, sample_date, week, month, year) %>%
                   summarize(vwc_per_wk = mean(vwc_percent, na.rm = TRUE)) %>%
                   ungroup()

soil_vwc_wk_trt_crop_full <- soil_vwc %>%
                   group_by(treatment, crop, sample_date, week, month, year) %>%
                   summarize(vwc_per_wk = mean(vwc_percent, na.rm = TRUE)) %>%
                   ungroup()

#average soil moisture by crop, edge/center, and date (combines treatments)
soil_vwc_wk_crop <- soil_vwc %>%
                    group_by(crop, bed_location, sample_date, week, month, year) %>%
                    summarize(vwc_per_wk = mean(vwc_percent, na.rm = TRUE)) %>%
                    ungroup()




#calculating the average soil moisture for difference in soil moisture between center and edge for each plot and day
soil_vwc_dif_plot <- soil_vwc_wk %>%
                     pivot_wider(names_from = bed_location,
                            values_from = vwc_avg_wk) %>%
                     mutate(vwc_plot = (center + edge)/2,
                            loc_dif = center - edge)

#calculating the treatment/crop average for difference in soil moisture between center and edge  for each day
soil_vwc_dif_trt_crop <- soil_vwc_dif_plot %>%
                         group_by(treatment, crop, sample_date, week, month, year) %>%
                         summarize(vwc_trt = mean(vwc_plot),
                                  vwc_dif_trt_avg = mean(loc_dif, na.rm = TRUE)) %>%
                         ungroup()

```

## Temperature

### Visualization

The three graphs below show the average daily temp, with each temp probe assigned a different color. It demonstrates that we have total coverage with at least one temp probe per treatment at all times. These graphs will not be in the publication
```{r}

ggplot(subset(soil_temp_day, treatment == "BM"), aes(x = date, y = day_avg, color = ID)) + geom_point() 

ggplot(subset(soil_temp_day, treatment == "CM"), aes(x = date, y = day_avg, color = ID)) + geom_point() 

ggplot(subset(soil_temp_day, treatment == "SM"), aes(x = date, y = day_avg, color = ID)) + geom_point() 

```
Following differences in average air temp, soil temperature was higher in 2023 compared to 2024, particularly in July and August (Table X, Figure X)

```{r}
# Make a table for this data

subset(soil_temp_month, month > 4 & month < 11)

```

Both cardboard mulch and straw mulch have a similarly moderating effect on average daily soil temperature. When the daily average air temperature in July 2023 and 2024 was 22C, for example, the soil temperature in mulched treatments remained several degrees cooler than the bare soil treatment; this trend was also apparent in March and April 2024, when bare soil warmed up faster than the mulched treatments. Conversely, when the air temperature dropped in October 2023, the soil temperature in mulched treatments remained slightly warmer than bare soil. 

```{r}
# Graphing the treatment average maximum daily soil temp perhaps shows the trends for bare soil a little more, but not so much that it's worth having an extra figure. 
#What to do with the straw mulch in 2024? I don't trust the soil temp probe from 5/15 to 6/30, because it is so suddenly and so extremely different than the others. It's replaced on 7/1.

# add note symbol for when mulch was applied, or make it show only after mulch is applied.
ggplot() + 
  geom_line(data = soil_temp_trt, 
       aes(x = date, 
           y = trt_avg, 
           color = treatment)) +
  theme_bw() +
  theme(axis.title.y = element_text(vjust = 3),
        axis.title.x = element_blank(),
        legend.position = "top") +
  ylab("Daily Average Soil Temperature (celcius)") +
  scale_color_manual(name = "Mulch Treatment", 
                    labels = c("Bare soil", "Shredded Cardboard", "Straw"), 
                    values = c("#A6CEE3", "#6A3D9A", "#CAB2D6")) +
    scale_x_date(breaks = as.Date(c("2023-06-01",
                                  "2023-09-01", 
                                  "2023-12-01", 
                                  "2024-03-01", 
                                  "2024-06-01", 
                                  "2024-09-01",
                                  "2024-12-01",  
                                  "2025-03-01")),
               minor_breaks = as.Date(c("2023-05-01",
                                  "2023-07-01",
                                  "2023-08-01",      
                                  "2023-10-01",
                                  "2023-11-01",
                                  "2024-01-01",
                                  "2024-02-01",
                                  "2024-04-01",
                                  "2024-05-01",
                                  "2024-07-01", 
                                  "2024-08-01",
                                  "2024-10-01",
                                  "2024-11-01", 
                                  "2025-01-01",
                                  "2025-02-01",
                                  "2025-04-01",
                                  "2025-05-01"
                                        )),
               labels = c("Jun 2023", "Sept 2023", "Dec 2023",
                          "Mar 2024", "Jun 2024", "Sept 2024", "Dec 2024",
                          "Mar 2025")) + 
  geom_vline(xintercept = as.numeric(as.Date("2023-06-22")), linetype = 2) + 
  geom_vline(xintercept = as.numeric(as.Date("2024-06-02")), linetype = 2)

ggsave("20250815_SCM_soil_temp_avg.png", width = 9, height = 6)

```

max - this is where the difference between treatments is coming from, but not as interesting as the graph showing differences
```{r}
ggplot() + 
  geom_line(data = subset(soil_temp_trt, year == "2023"), 
       aes(x = date, 
           y = trt_avg_max, 
           color = treatment)) +
  geom_line(data = subset(temp_precip_day, year == "2023" & 
                                    month > 5), 
            aes(x = date, 
                y = max_temp_C), color = "gray", linetype = 2) +
  theme_bw()


ggplot() + 
  geom_line(data = subset(soil_temp_trt, year == "2024"), 
       aes(x = date, 
           y = trt_avg_max, 
           color = treatment)) +
  geom_line(data = subset(temp_precip_day, year == "2024"), 
            aes(x = date, 
                y = max_temp_C), color = "gray", linetype = 2) +
  theme_bw()


```

min - there aren't really differences between treatments
```{r}
ggplot() + 
  geom_line(data = subset(soil_temp_trt, year == "2023"), 
       aes(x = date, 
           y = trt_avg_min, 
           color = treatment)) +
  geom_line(data = subset(temp_precip_day, year == "2023" & 
                                    month > 5), 
            aes(x = date, 
                y = min_temp_C), color = "gray", linetype = 2) +
  theme_bw()


ggplot() + 
  geom_line(data = subset(soil_temp_trt, year == "2024"), 
       aes(x = date, 
           y = trt_avg_min, 
           color = treatment)) +
  geom_line(data = subset(temp_precip_day, year == "2024"), 
            aes(x = date, 
                y = min_temp_C), color = "gray", linetype = 2) +
  theme_bw()


```

Difference between max and min temp
```{r}
ggplot() + 
  geom_line(data = subset(soil_temp_trt), 
       aes(x = date, 
           y = trt_dif, 
           color = treatment), linewidth = .5) +
  theme_bw()+ 
  theme(axis.title.y = element_text(vjust = 3),
        axis.title.x = element_blank(),
        legend.position = "inside",
        legend.position.inside = c(0.8,0.75)) +
  ylab("Difference between max and min temp (celcius)") +
  scale_color_manual(name = "Mulch Treatment", 
                    labels = c("Bare soil", "Shredded Cardboard", "Straw"), 
                    values = c("#A6CEE3", "#6A3D9A", "#CAB2D6")) +
  scale_x_date(breaks = as.Date(c("2023-06-01",
                                  "2023-09-01", 
                                  "2023-12-01", 
                                  "2024-03-01", 
                                  "2024-06-01", 
                                  "2024-09-01",
                                  "2024-12-01",  
                                  "2025-03-01")),
               minor_breaks = as.Date(c("2023-07-01",
                                  "2023-08-01",      
                                  "2023-10-01",
                                  "2023-11-01",
                                  "2024-01-01",
                                  "2024-02-01",
                                  "2024-04-01",
                                  "2024-05-01",
                                  "2024-07-01", 
                                  "2024-08-01",
                                  "2024-10-01",
                                  "2024-11-01", 
                                  "2025-01-01",
                                  "2025-02-01",
                                  "2025-04-01",
                                  "2025-05-01"
                                        )),
               labels = c("Jun 2023", "Sept 2023", "Dec 2023",
                          "Mar 2024", "Jun 2024", "Sept 2024", "Dec 2024",
                          "Mar 2025"))  

ggsave("20250815_SCM_soil_temp_dif.png", width = 9, height = 6)



```


While our study focused on the growing season between May and October, this trend was consistent over winter and in the spring, prior to mulch removal and planting.

```{r}
# I need to change the aesthetics so that the air temperature is a dashed, gray line
ggplot() + 
  geom_line(data = subset(soil_temp_trt, study_yr == 1), aes(x = date, y = trt_avg, color = treatment)) +
  geom_line(data = subset(temp_precip_day, (year == "2023" & month > 4) | (year == "2024" & month < 5)), 
            aes(x = date, y = avg_temp_C)) +
  theme_bw()

ggplot() +
  geom_line(data = subset(soil_temp_trt, study_yr == 2), aes(x = date, y = trt_avg, color = treatment)) + 
  geom_line(data = subset(temp_precip_day, (year == "2024" & month > 4) | (year == "2025" & month < 5)), 
            aes(x = date, y = avg_temp_C)) +
  theme_bw()

```
Just when we have multiple temp probes
```{r}
first_mon <- soil_temp_day %>%
             subset(date < "2023-07-21") %>%
             mutate(mulch = ifelse(date < "2023-06-23", "pre-mulch",
                                   "post-mulch")) %>%
             mutate_at('mulch', as.factor) %>%
             mutate(mulch = relevel(mulch, ref = "pre-mulch"))

first_mon_avg <- first_mon %>%
                 group_by(treatment, year, week, month, date, mulch) %>%
                 summarize(trt_avg_max = mean(day_max, na.rm = TRUE),
                           trt_avg_min = mean(day_min, na.rm = TRUE),
                           trt_avg = (trt_avg_max + trt_avg_min)/2,
                           trt_dif = trt_avg_max - trt_avg_min) %>%
                 ungroup()

ggplot() + 
  geom_point(data = first_mon, aes(x=date, y = day_avg, color = treatment), size = 0.5) + 
  geom_line(data = first_mon_avg, aes(x=date, y=trt_avg, color = treatment), linewidth = 0.75) +
  theme_bw() +
  theme(axis.title.y = element_text(vjust = 3),
        axis.title.x = element_blank(),
        legend.position = "top") +
  ylab("Daily Average Soil Temperature (celcius)") +
  scale_color_manual(name = "Mulch Treatment", 
                    labels = c("Bare soil", "Shredded Cardboard", "Straw"), 
                    values = c("#A6CEE3", "#6A3D9A", "#CAB2D6")) +
  scale_x_date(breaks = as.Date(c("2023-06-01", 
                                  "2023-06-15",
                                  "2023-07-01", 
                                  "2023-07-15")),
               minor_breaks = as.Date(c("2023-05-15",
                                  "2023-07-30")),
                              labels = c("Jun 1", "Jun 15", 
                          "Jul 1", "Jul 15")) + 
  geom_vline(xintercept = as.numeric(as.Date("2023-06-22")), linetype = 2)

  
ggsave("20250815_SCM_soil_temp_2023.png", width = 6, height = 4)
```

```{r}
model <- aov(day_avg ~ treatment, data = subset(first_mon, mulch == "pre-mulch"))
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(day_avg ~ treatment, data = subset(first_mon, mulch == "post-mulch"))
summary(model)
TukeyHSD(model)
plot(model)

```



## Irrigation and Precipitation
During the growing season in 2023, there was 22.8 inches of rain recorded at the nearby weather station and 7.4 inches of water were applied to the study area via drip irrigation. Drip irrigation was largely utilized during a five week drought in May/June and a three week drought in August. In contrast, 2024 was a much wetter year, especially at the beginning of the season; there was 27.3 in of rain recorded and 2.4 inches of water were applied via drip irrigation during May and June. Only one irrigation event, at the end of June, was needed after the mulch treatments were applied. While there was also a period with minimal rain in late September/early October, we did not irrigate because the air temperatures were lower, bean/strawberry crops were not producing anymore, and the collards were not showing signs of water stress.


### Visualization
```{r}
#I'm largely sticking to bar graphs here because I'll combine with the soil moisture visualization eventually

# daily
ggplot(subset(irrigation_day, month > 4 & month < 11 & year == 2023), aes(x = factor(date), y = irrigation_mm, fill=type, color = type)) + geom_bar(stat = "identity") 
  
ggplot(subset(irrigation_day, month > 4 & month < 11 & year == 2024), aes(x = factor(date), y = irrigation_mm, fill=type, color = type)) + geom_bar(stat = "identity") 

# weekly
ggplot(subset(irrigation_wk, month > 4 & month < 11), aes(x = factor(week), y = irrigation_mm, fill=type)) + geom_bar(stat = "identity", position = "dodge", width = 0.75) + facet_wrap(~year) +
  theme_bw() + 
  xlab("Weeks after January 1") +
  ylab("Water input (in)") +
  scale_fill_manual(name = "Input Type", 
                    labels = c("Drip Irrigation", "Precipitation"), 
                    values = c("#FC8D62", "#66C2A5")) + 
  theme(axis.text.x = element_text(size = 6))

ggsave("20250811_SCM_water_input.png", width = 9, height = 4)


  
ggplot(subset(irrigation_wk, month > 4 & month < 11 & year == 2024), aes(x = factor(week), y = irrigation_mm, fill=type, color = type)) + geom_bar(stat = "identity", position = "dodge") 

# monthly
ggplot(subset(irrigation_mon, month > 4 & month < 11 & year == 2023), aes(x = factor(month), y = irrigation_mm, fill=type, color = type)) + geom_bar(stat = "identity", position = "dodge") 
  
ggplot(subset(irrigation_mon, month > 4 & month < 11 & year == 2024), aes(x = factor(month), y = irrigation_mm, fill=type, color = type)) + geom_bar(stat = "identity", position = "dodge") 

# season
ggplot(irrigation_season, aes(x = factor(year), y = irrigation_mm, fill=type, color = type)) + geom_bar(stat = "identity", position = "dodge") 



```

## Soil Moisture

#### For manuscript

##### Statistical Analysis

```{r}
sum_stat_vwc_overall_c <- soil_vwc %>%
                        group_by(treatment, crop) %>%
                summarize(min = min(vwc_percent, na.rm = TRUE),
                          median = median(vwc_percent, na.rm = TRUE),
                          max = max(vwc_percent, na.rm = TRUE),
                          mean = mean(vwc_percent, na.rm = TRUE),
                          sd = sd(vwc_percent, na.rm = TRUE))  

sum_stat_vwc_overall <- soil_vwc %>%
                        group_by(treatment, year) %>%
                summarize(min = min(vwc_percent, na.rm = TRUE),
                          median = median(vwc_percent, na.rm = TRUE),
                          max = max(vwc_percent, na.rm = TRUE),
                          mean = mean(vwc_percent, na.rm = TRUE),
                          sd = sd(vwc_percent, na.rm = TRUE))  

sum_stat_vwc_c <- soil_vwc %>%
                group_by(year, month, treatment, crop) %>%
                summarize(min = min(vwc_percent, na.rm = TRUE),
                          median = median(vwc_percent, na.rm = TRUE),
                          max = max(vwc_percent, na.rm = TRUE),
                          mean = mean(vwc_percent, na.rm = TRUE),
                          sd = sd(vwc_percent, na.rm = TRUE))

write.csv(sum_stat_vwc_c, here::here("20250815_SCM_soil_vwc_c.csv"), row.names=TRUE)

sum_stat_vwc <- soil_vwc %>%
                group_by(year, month, treatment) %>%
                summarize(min = min(vwc_percent, na.rm = TRUE),
                          median = median(vwc_percent, na.rm = TRUE),
                          max = max(vwc_percent, na.rm = TRUE),
                          mean = mean(vwc_percent, na.rm = TRUE),
                          sd = sd(vwc_percent, na.rm = TRUE))

write.csv(sum_stat_vwc, here::here("20250815_SCM_soil_vwc.csv"), row.names=TRUE)

#Overall LMM
model <- lmer(vwc_percent ~ treatment*crop + (1 | sample_date/block), data = soil_vwc)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ treatment)

#2023 only LMM
model <- lmer(vwc_percent ~ treatment*crop + (1 | sample_date/block), data = soil_vwc_23)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ treatment)

#2024 only (I had my doubts that the LMM met model assumptions)
model <- aov(vwc_percent ~ treatment*crop, soil_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)
```

##### Figures and Tables

```{r}
# Weekly

ggplot() + 
  geom_point(data = soil_vwc, aes(x = sample_date, y = vwc_percent, color = treatment), size = 0.75) + 
  geom_line(data = soil_vwc_wk_trt_crop_full, aes(x = sample_date, y = vwc_per_wk, color = treatment), linewidth = 1) +  
  facet_wrap(~year + crop, scales = "free_x") +
  theme_bw() + 
  theme(axis.title.y = element_text(vjust = 3),
        axis.title.x = element_blank(), 
        legend.position = "top") +
  ylab("Soil Moisture (%)") +
  scale_color_manual(name = "Mulch Treatment", 
                    labels = c("Bare soil", "Shredded Cardboard", "Straw"), 
                    values = c("#A6CEE3", "#6A3D9A", "#CAB2D6"))

ggsave("20250815_SCM_soil_moisture_crop.png")


ggplot() + 
  geom_point(data = soil_vwc, aes(x = sample_date, y = vwc_percent, color = treatment), size = 0.75) + 
  geom_line(data = soil_vwc_wk_trt_full, aes(x = sample_date, y = vwc_per_wk, color = treatment), linewidth = 1) +  
  facet_wrap(~year, scales = "free_x", dir = "v") +
  theme_bw() + 
  theme(axis.title.y = element_text(vjust = 3),
        axis.title.x = element_blank(), 
        legend.position = "top") +
  ylab("Soil Moisture (%)") +
  scale_color_manual(name = "Mulch Treatment", 
                    labels = c("Bare soil", "Shredded Cardboard", "Straw"), 
                    values = c("#A6CEE3", "#6A3D9A", "#CAB2D6"))

ggsave("20250815_SCM_soil_moisture.png")


# Real time

ggplot(data = soil_vwc_rt, 
       aes(x = date.time, 
           y = vwc_percent, 
           color = treatment)) + 
  geom_line() +
  theme_bw() +
  theme(axis.title.y = element_text(vjust = 3),
        axis.title.x = element_blank(),
        legend.position = "top") +
  ylab("Soil Moisture (%)") +
  scale_color_manual(name = "Mulch Treatment", 
                    labels = c("Bare soil", "Shredded Cardboard", "Straw"), 
                    values = c("#A6CEE3", "#6A3D9A", "#CAB2D6")) +
  scale_x_datetime(breaks = as.POSIXct(c("2023-07-01", 
                                  "2023-08-01", 
                                  "2023-09-01", 
                                  "2023-10-01")),
               labels = c("Jul 2023", "Aug 2023", "Sept 2023",
                          "Oct 2023"))

ggsave("20250815_SCM_vwc_rt.png")

```

### Visualization

Overview boxplots to diagnose problems. Addressed a row with NA for crop and treatment and changed bed location names to be consistent across years. Noting that there is definitely a differnce in soil moisture at the edge of plot between years (2024 is higher). Range of soil moisture values for edge is wider than for the centers. Average values don't seem much different between treatments and crops
```{r}
ggplot(soil_vwc, aes(x = treatment, y = vwc_percent, fill = bed_location)) + geom_boxplot() + facet_grid(~crop) + ggtitle("Soil Moisture for Edge vs. Center of plot")

ggplot(soil_vwc, aes(x = crop, y = vwc_percent, fill = treatment)) + geom_boxplot() + facet_wrap(~year + bed_location) + ggtitle("Soil Moisture by Bed location and year")

ggplot(soil_vwc_dif_plot, aes(x = crop, y = loc_dif, fill = treatment)) + geom_boxplot() + facet_grid(~year)

 

```

Here, I visualize the soil moisture across the season for each treatment-crop-year. Soil moisture in the centers is visually similar for all treatments each week; a difference between treatments is clearer in 2024.
```{r}


  

#based on readings, I think this is actually the plot I'll uses in the publication
ggplot(subset(soil_vwc, year == 2023), aes(x = as.factor(week), y = vwc_percent, fill = treatment)) + geom_boxplot() + facet_grid(~crop)
ggplot(subset(soil_vwc, year == 2024), aes(x = as.factor(week), y = vwc_percent, fill = treatment)) + geom_boxplot() + facet_grid(~crop)

ggplot(subset(soil_vwc, year == 2023 & bed_location == "center"), aes(x = as.factor(week), y = vwc_percent, fill = treatment)) + geom_boxplot() + facet_grid(~crop)
ggplot(subset(soil_vwc, year == 2024 & bed_location == "center"), aes(x = as.factor(week), y = vwc_percent, fill = treatment)) + geom_boxplot() + facet_grid(~crop)

ggplot(subset(soil_vwc, year == 2023 & bed_location == "edge"), aes(x = as.factor(week), y = vwc_percent, fill = treatment)) + geom_boxplot() + facet_grid(~crop)
ggplot(subset(soil_vwc, year == 2024 & bed_location == "edge"), aes(x = as.factor(week), y = vwc_percent, fill = treatment)) + geom_boxplot() + facet_grid(~crop)

```




### Normality

##### Overall 

The original dataset is non-parametric with a lambda of 1.3, indicating that a boxcox or squared transformation would be most appropriate. Neither is successful
```{r}
#original dataset
hist(soil_vwc$vwc_percent)
skewness(soil_vwc$vwc_percent, na.rm = TRUE)
qqnorm(soil_vwc$vwc_percent, main='Normal')
qqline(soil_vwc$vwc_percent)
shapiro.test(soil_vwc$vwc_percent)

#boxcox
bc <- boxcox(lm(soil_vwc$vwc_percent ~ 1))
lambda <- bc$x[which.max(bc$y)]
soil_vwc$bc_vwc <- (soil_vwc$vwc_percent ^ lambda-1)/lambda

skewness(soil_vwc$bc_vwc, na.rm = TRUE)
hist(soil_vwc$bc_vwc)
qqnorm(soil_vwc$bc_vwc, main='Normal')
qqline(soil_vwc$bc_vwc)
shapiro.test(soil_vwc$bc_vwc)

#squared
soil_vwc$sq_vwc <- soil_vwc$vwc_percent^2

skewness(soil_vwc$sq_vwc, na.rm = TRUE)
hist(soil_vwc$sq_vwc)
qqnorm(soil_vwc$sq_vwc, main='Normal')
qqline(soil_vwc$sq_vwc)
shapiro.test(soil_vwc$sq_vwc)

```
2023: the original dataset is non-parametric with a lambda ~1, indicating that a boxcox transformation would be most appropriate. It is not successful
```{r}
soil_vwc_23 <- subset(soil_vwc, year == "2023")

#original dataset
hist(soil_vwc_23$vwc_percent)
skewness(soil_vwc_23$vwc_percent, na.rm = TRUE)
qqnorm(soil_vwc_23$vwc_percent, main='Normal')
qqline(soil_vwc_23$vwc_percent)
shapiro.test(soil_vwc_23$vwc_percent)

#boxcox
bc <- boxcox(lm(soil_vwc_23$vwc_percent ~ 1))
lambda <- bc$x[which.max(bc$y)]
soil_vwc_23$bc_vwc <- (soil_vwc_23$vwc_percent ^ lambda-1)/lambda

skewness(soil_vwc_23$bc_vwc, na.rm = TRUE)
hist(soil_vwc_23$bc_vwc)
qqnorm(soil_vwc_23$bc_vwc, main='Normal')
qqline(soil_vwc_23$bc_vwc)
shapiro.test(soil_vwc_23$bc_vwc)


```

2024: the original dataset is non-parametric with a lambda ~2, indicating that a boxcox or squared transformation would be most appropriate. Neither is successful
```{r}
soil_vwc_24 <- subset(soil_vwc, year == "2024")

#original dataset
hist(soil_vwc_24$vwc_percent)
skewness(soil_vwc_24$vwc_percent, na.rm = TRUE)
qqnorm(soil_vwc_24$vwc_percent, main='Normal')
qqline(soil_vwc_24$vwc_percent)
shapiro.test(soil_vwc_24$vwc_percent)

#boxcox
bc <- boxcox(lm(soil_vwc_24$vwc_percent ~ 1))
lambda <- bc$x[which.max(bc$y)]
soil_vwc_24$bc_vwc <- (soil_vwc_24$vwc_percent ^ lambda-1)/lambda

skewness(soil_vwc_24$bc_vwc, na.rm = TRUE)
hist(soil_vwc_24$bc_vwc)
qqnorm(soil_vwc_24$bc_vwc, main='Normal')
qqline(soil_vwc_24$bc_vwc)
shapiro.test(soil_vwc_24$bc_vwc)

#squared
soil_vwc_24$sq_vwc <- soil_vwc_24$vwc_percent^2

skewness(soil_vwc_24$sq_vwc, na.rm = TRUE)
hist(soil_vwc_24$sq_vwc)
qqnorm(soil_vwc_24$sq_vwc, main='Normal')
qqline(soil_vwc_24$sq_vwc)
shapiro.test(soil_vwc_24$sq_vwc)
```

##### Center only 

The original dataset is non-parametric with a lambda of 1.4, indicating that a boxcox or squared transformation would be most appropriate. Neither is successful
```{r}
center_vwc <- subset(soil_vwc, bed_location == "center")

#original dataset
hist(center_vwc$vwc_percent)
skewness(center_vwc$vwc_percent, na.rm = TRUE)
qqnorm(center_vwc$vwc_percent, main='Normal')
qqline(center_vwc$vwc_percent)
shapiro.test(center_vwc$vwc_percent)

#boxcox
bc <- boxcox(lm(center_vwc$vwc_percent ~ 1))
lambda <- bc$x[which.max(bc$y)]
center_vwc$bc_vwc <- (center_vwc$vwc_percent ^ lambda-1)/lambda

skewness(center_vwc$bc_vwc, na.rm = TRUE)
hist(center_vwc$bc_vwc)
qqnorm(center_vwc$bc_vwc, main='Normal')
qqline(center_vwc$bc_vwc)
shapiro.test(center_vwc$bc_vwc)

#squared
center_vwc$sq_vwc <- center_vwc$vwc_percent^2

skewness(center_vwc$sq_vwc, na.rm = TRUE)
hist(center_vwc$sq_vwc)
qqnorm(center_vwc$sq_vwc, main='Normal')
qqline(center_vwc$sq_vwc)
shapiro.test(center_vwc$sq_vwc)

```

2023 only: The original dataset is non-parametric with a lambda of 1.3, indicating that a boxcox or squared transformation would be most appropriate. Neither is successful
```{r}
center_vwc_23 <- subset(center_vwc, year == "2023")

#original dataset
hist(center_vwc_23$vwc_percent)
skewness(center_vwc_23$vwc_percent, na.rm = TRUE)
qqnorm(center_vwc_23$vwc_percent, main='Normal')
qqline(center_vwc_23$vwc_percent)
shapiro.test(center_vwc_23$vwc_percent)

#boxcox
bc <- boxcox(lm(center_vwc_23$vwc_percent ~ 1))
lambda <- bc$x[which.max(bc$y)]
center_vwc_23$bc_vwc <- (center_vwc_23$vwc_percent ^ lambda-1)/lambda

skewness(center_vwc_23$bc_vwc, na.rm = TRUE)
hist(center_vwc_23$bc_vwc)
qqnorm(center_vwc_23$bc_vwc, main='Normal')
qqline(center_vwc_23$bc_vwc)
shapiro.test(center_vwc_23$bc_vwc)

#squared
center_vwc_23$sq_vwc <- center_vwc_23$vwc_percent^2

skewness(center_vwc_23$sq_vwc, na.rm = TRUE)
hist(center_vwc_23$sq_vwc)
qqnorm(center_vwc_23$sq_vwc, main='Normal')
qqline(center_vwc_23$sq_vwc)
shapiro.test(center_vwc_23$sq_vwc)

```

2024 only: The original dataset is non-parametric with a lambda of 1.8, indicating that a boxcox or squared transformation would be most appropriate. Neither is successful
```{r}
center_vwc_24 <- subset(center_vwc, year == "2024")

#original dataset
hist(center_vwc_24$vwc_percent)
skewness(center_vwc_24$vwc_percent, na.rm = TRUE)
qqnorm(center_vwc_24$vwc_percent, main='Normal')
qqline(center_vwc_24$vwc_percent)
shapiro.test(center_vwc_24$vwc_percent)

#boxcox
bc <- boxcox(lm(center_vwc_24$vwc_percent ~ 1))
lambda <- bc$x[which.max(bc$y)]
center_vwc_24$bc_vwc <- (center_vwc_24$vwc_percent ^ lambda-1)/lambda

skewness(center_vwc_24$bc_vwc, na.rm = TRUE)
hist(center_vwc_24$bc_vwc)
qqnorm(center_vwc_24$bc_vwc, main='Normal')
qqline(center_vwc_24$bc_vwc)
shapiro.test(center_vwc_24$bc_vwc)

#squared
center_vwc_24$sq_vwc <- center_vwc_24$vwc_percent^2

skewness(center_vwc_24$sq_vwc, na.rm = TRUE)
hist(center_vwc_24$sq_vwc)
qqnorm(center_vwc_24$sq_vwc, main='Normal')
qqline(center_vwc_24$sq_vwc)
shapiro.test(center_vwc_24$sq_vwc)

```


##### Edge only 

The original dataset is non-parametric with a lambda of 1, indicating that a boxcox or squared transformation would be most appropriate. Neither is successful
```{r}
edge_vwc <- subset(soil_vwc, bed_location == "edge")

#original dataset
hist(edge_vwc$vwc_percent)
skewness(edge_vwc$vwc_percent, na.rm = TRUE)
qqnorm(edge_vwc$vwc_percent, main='Normal')
qqline(edge_vwc$vwc_percent)
shapiro.test(edge_vwc$vwc_percent)

#boxcox
bc <- boxcox(lm(edge_vwc$vwc_percent ~ 1))
lambda <- bc$x[which.max(bc$y)]
edge_vwc$bc_vwc <- (edge_vwc$vwc_percent ^ lambda-1)/lambda

skewness(edge_vwc$bc_vwc, na.rm = TRUE)
hist(edge_vwc$bc_vwc)
qqnorm(edge_vwc$bc_vwc, main='Normal')
qqline(edge_vwc$bc_vwc)
shapiro.test(edge_vwc$bc_vwc)

```

2023 only: The original dataset is non-parametric with a lambda of 0.2, indicating that a boxcox or log transformation would be most appropriate. Neither is successful
```{r}
edge_vwc_23 <- subset(edge_vwc, year == "2023")

#original dataset
hist(edge_vwc_23$vwc_percent)
skewness(edge_vwc_23$vwc_percent, na.rm = TRUE)
qqnorm(edge_vwc_23$vwc_percent, main='Normal')
qqline(edge_vwc_23$vwc_percent)
shapiro.test(edge_vwc_23$vwc_percent)

#boxcox
bc <- boxcox(lm(edge_vwc_23$vwc_percent ~ 1))
lambda <- bc$x[which.max(bc$y)]
edge_vwc_23$bc_vwc <- (edge_vwc_23$vwc_percent ^ lambda-1)/lambda

skewness(edge_vwc_23$bc_vwc, na.rm = TRUE)
hist(edge_vwc_23$bc_vwc)
qqnorm(edge_vwc_23$bc_vwc, main='Normal')
qqline(edge_vwc_23$bc_vwc)
shapiro.test(edge_vwc_23$bc_vwc)

#log
edge_vwc_23$log_vwc <- log(edge_vwc_23$vwc_percent)

skewness(edge_vwc_23$log_vwc, na.rm = TRUE)
hist(edge_vwc_23$log_vwc)
qqnorm(edge_vwc_23$log_vwc, main='Normal')
qqline(edge_vwc_23$log_vwc)
shapiro.test(edge_vwc_23$log_vwc)

```

2024 only: The original dataset is non-parametric with a lambda of 2, indicating that a boxcox or squared transformation would be most appropriate. Neither is successful
```{r}
edge_vwc_24 <- subset(edge_vwc, year == "2024")

#original dataset
hist(edge_vwc_24$vwc_percent)
skewness(edge_vwc_24$vwc_percent, na.rm = TRUE)
qqnorm(edge_vwc_24$vwc_percent, main='Normal')
qqline(edge_vwc_24$vwc_percent)
shapiro.test(edge_vwc_24$vwc_percent)

#boxcox
bc <- boxcox(lm(edge_vwc_24$vwc_percent ~ 1))
lambda <- bc$x[which.max(bc$y)]
edge_vwc_24$bc_vwc <- (edge_vwc_24$vwc_percent ^ lambda-1)/lambda

skewness(edge_vwc_24$bc_vwc, na.rm = TRUE)
hist(edge_vwc_24$bc_vwc)
qqnorm(edge_vwc_24$bc_vwc, main='Normal')
qqline(edge_vwc_24$bc_vwc)
shapiro.test(edge_vwc_24$bc_vwc)

#squared
edge_vwc_24$sq_vwc <- edge_vwc_24$vwc_percent^2

skewness(edge_vwc_24$sq_vwc, na.rm = TRUE)
hist(edge_vwc_24$sq_vwc)
qqnorm(edge_vwc_24$sq_vwc, main='Normal')
qqline(edge_vwc_24$sq_vwc)
shapiro.test(edge_vwc_24$sq_vwc)

```

### Analysis 


#### Both bed locations

##### Overall
```{r}
# There are treatment, crop, year, treatment*year, and crop*year interactions.
model <- aov(vwc_percent ~ treatment*crop*year, soil_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment*year, soil_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ crop*year, soil_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment*crop, soil_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

#KW
kruskal.test(vwc_percent~treatment, data = soil_vwc)
dunnTest(vwc_percent~treatment, data = soil_vwc)

kruskal.test(vwc_percent~crop, data = soil_vwc)
dunnTest(vwc_percent~crop, data = soil_vwc)

kruskal.test(vwc_percent~year, data = soil_vwc)

kruskal.test(vwc_percent~year, data = subset(soil_vwc, crop == "AS"))
kruskal.test(vwc_percent~year, data = subset(soil_vwc, crop == "DB"))
kruskal.test(vwc_percent~year, data = subset(soil_vwc, crop == "FC"))

#LMM
model <- lmer(vwc_percent ~ treatment*crop + (1 | sample_date), data = soil_vwc)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ treatment)

```


##### 2023
```{r}
# There are treatment, crop, year, treatment*year, and crop*year interactions.
model <- aov(vwc_percent ~ treatment*crop, soil_vwc_23)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment, soil_vwc_23)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ crop, soil_vwc_23)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

#KW
kruskal.test(vwc_percent~treatment, data = soil_vwc_23)
dunnTest(vwc_percent~treatment, data = soil_vwc_23)

kruskal.test(vwc_percent~crop, data = soil_vwc_23)
dunnTest(vwc_percent~crop, data = soil_vwc_23)

kruskal.test(vwc_percent~treatment, data = subset(soil_vwc_23, crop == "AS"))
dunnTest(vwc_percent~treatment, data = subset(soil_vwc_23, crop == "AS"))

kruskal.test(vwc_percent~treatment, data = subset(soil_vwc_23, crop == "DB"))
dunnTest(vwc_percent~treatment, data = subset(soil_vwc_23, crop == "DB"))

kruskal.test(vwc_percent~treatment, data = subset(soil_vwc_23, crop == "FC"))
dunnTest(vwc_percent~treatment, data = subset(soil_vwc_23, crop == "FC"))

#LMM
model <- lmer(vwc_percent ~ crop + (1 | sample_date/block), data = soil_vwc_23)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ crop)

```


##### 2024
```{r}
# There are treatment, crop, year, treatment*year, and crop*year interactions.
model <- aov(vwc_percent ~ treatment*crop, soil_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment, soil_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ crop, soil_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

#KW
kruskal.test(vwc_percent~treatment, data = soil_vwc_24)
dunnTest(vwc_percent~treatment, data = soil_vwc_24)

kruskal.test(vwc_percent~crop, data = soil_vwc_24)
dunnTest(vwc_percent~crop, data = soil_vwc_24)

kruskal.test(vwc_percent~treatment, data = subset(soil_vwc_24, crop == "AS"))
dunnTest(vwc_percent~treatment, data = subset(soil_vwc_24, crop == "AS"))

kruskal.test(vwc_percent~treatment, data = subset(soil_vwc_24, crop == "DB"))
dunnTest(vwc_percent~treatment, data = subset(soil_vwc_24, crop == "DB"))

kruskal.test(vwc_percent~treatment, data = subset(soil_vwc_24, crop == "FC"))
dunnTest(vwc_percent~treatment, data = subset(soil_vwc_24, crop == "FC"))

#LMM: these really don't look normally distributed
model <- lmer(vwc_percent ~ treatment*crop + (1 | sample_date/block), data = soil_vwc_24)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ treatment)

```


#### Centers

##### Overall
```{r}
# There are treatment, crop, year, treatment*year, and crop*year interactions.
model <- aov(vwc_percent ~ treatment*crop*year, center_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment*year, center_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ crop*year, center_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment*crop, center_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

#KW
kruskal.test(vwc_percent~treatment, data = center_vwc)
dunnTest(vwc_percent~treatment, data = center_vwc)

kruskal.test(vwc_percent~crop, data = center_vwc)
dunnTest(vwc_percent~crop, data = center_vwc)

kruskal.test(vwc_percent~year, data = center_vwc)

kruskal.test(vwc_percent~year, data = subset(center_vwc, crop == "AS"))
kruskal.test(vwc_percent~year, data = subset(center_vwc, crop == "DB"))
kruskal.test(vwc_percent~year, data = subset(center_vwc, crop == "FC"))

#LMM
model <- lmer(vwc_percent ~ treatment*crop + (1 | sample_date), data = center_vwc)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ crop)

```
##### 2023
```{r}
# There are treatment, crop, year, treatment*year, and crop*year interactions.
model <- aov(vwc_percent ~ treatment*crop, center_vwc_23)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment, center_vwc_23)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ crop, center_vwc_23)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

#KW
kruskal.test(vwc_percent~treatment, data = center_vwc_23)
dunnTest(vwc_percent~treatment, data = center_vwc_23)

kruskal.test(vwc_percent~crop, data = center_vwc_23)
dunnTest(vwc_percent~crop, data = center_vwc_23)

kruskal.test(vwc_percent~treatment, data = subset(center_vwc_23, crop == "AS"))
kruskal.test(vwc_percent~treatment, data = subset(center_vwc_23, crop == "DB"))
kruskal.test(vwc_percent~treatment, data = subset(center_vwc_23, crop == "FC"))

kruskal.test(vwc_percent~crop, data = subset(center_vwc_23, treatment == "BM"))
dunnTest(vwc_percent~crop, data = subset(center_vwc_23, treatment == "BM"))

kruskal.test(vwc_percent~crop, data = subset(center_vwc_23, treatment == "SM"))
dunnTest(vwc_percent~crop, data = subset(center_vwc_23, treatment == "SM"))

kruskal.test(vwc_percent~crop, data = subset(center_vwc_23, treatment == "CM"))
dunnTest(vwc_percent~crop, data = subset(center_vwc_23, treatment == "CM"))

#LMM
model <- lmer(vwc_percent ~ crop + (1 | sample_date/block), data = center_vwc_23)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ crop)

```
##### 2024
```{r}
# There are treatment, crop, year, treatment*year, and crop*year interactions.
model <- aov(vwc_percent ~ treatment*crop, center_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment, center_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ crop, center_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

#KW
kruskal.test(vwc_percent~treatment, data = center_vwc_24)
dunnTest(vwc_percent~treatment, data = center_vwc_24)

kruskal.test(vwc_percent~crop, data = center_vwc_24)
dunnTest(vwc_percent~crop, data = center_vwc_24)

kruskal.test(vwc_percent~treatment, data = subset(center_vwc_24, crop == "AS"))
dunnTest(vwc_percent~treatment, data = subset(center_vwc_24, crop == "AS"))

kruskal.test(vwc_percent~treatment, data = subset(center_vwc_24, crop == "DB"))
dunnTest(vwc_percent~treatment, data = subset(center_vwc_24, crop == "DB"))

kruskal.test(vwc_percent~treatment, data = subset(center_vwc_24, crop == "FC"))
dunnTest(vwc_percent~treatment, data = subset(center_vwc_24, crop == "FC"))

#LMM: these really don't look normally distributed
model <- lmer(vwc_percent ~ treatment*crop + (1 | sample_date), data = center_vwc_24)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ treatment)

```

#### Edges

##### Overall
```{r}
# There are treatment, crop, year, treatment*year, and crop*year interactions.
model <- aov(vwc_percent ~ treatment*crop*year, edge_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment*year, edge_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ crop*year, edge_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment*crop, edge_vwc)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

#KW
kruskal.test(vwc_percent~treatment, data = edge_vwc)
dunnTest(vwc_percent~treatment, data = edge_vwc)

kruskal.test(vwc_percent~crop, data = edge_vwc)
dunnTest(vwc_percent~crop, data = edge_vwc)

kruskal.test(vwc_percent~year, data = edge_vwc)

kruskal.test(vwc_percent~year, data = subset(edge_vwc, treatment == "BM"))
kruskal.test(vwc_percent~year, data = subset(edge_vwc, treatment == "SM"))
kruskal.test(vwc_percent~year, data = subset(edge_vwc, treatment == "CM"))

#LMM
model <- lmer(vwc_percent ~ treatment + (1 | sample_date/block), data = edge_vwc)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ treatment)

```
##### 2023
```{r}
# There are treatment, crop, year, treatment*year, and crop*year interactions.
model <- aov(vwc_percent ~ treatment*crop, edge_vwc_23)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment, edge_vwc_23)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ crop, edge_vwc_23)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

#KW
kruskal.test(vwc_percent~treatment, data = edge_vwc_23)
dunnTest(vwc_percent~treatment, data = edge_vwc_23)

kruskal.test(vwc_percent~crop, data = edge_vwc_23)
dunnTest(vwc_percent~crop, data = edge_vwc_23)

kruskal.test(vwc_percent~treatment, data = subset(edge_vwc_23, crop == "AS"))
kruskal.test(vwc_percent~treatment, data = subset(edge_vwc_23, crop == "DB"))
kruskal.test(vwc_percent~treatment, data = subset(edge_vwc_23, crop == "FC"))
dunnTest(vwc_percent~treatment, data = subset(edge_vwc_23, crop == "FC"))

kruskal.test(vwc_percent~crop, data = subset(edge_vwc_23, treatment == "BM"))
dunnTest(vwc_percent~crop, data = subset(edge_vwc_23, treatment == "BM"))

kruskal.test(vwc_percent~crop, data = subset(edge_vwc_23, treatment == "SM"))
dunnTest(vwc_percent~crop, data = subset(edge_vwc_23, treatment == "SM"))

kruskal.test(vwc_percent~crop, data = subset(edge_vwc_23, treatment == "CM"))
dunnTest(vwc_percent~crop, data = subset(edge_vwc_23, treatment == "CM"))

#LMM
model <- lmer(vwc_percent ~ crop + (1 | sample_date/block), data = edge_vwc_23)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ crop)

```
##### 2024
```{r}
# There are treatment, crop, year, treatment*year, and crop*year interactions.
model <- aov(vwc_percent ~ treatment*crop, edge_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ treatment, edge_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

model <- aov(vwc_percent ~ crop, edge_vwc_24)
AIC(model)
summary(model)
TukeyHSD(model)
plot(model)

#KW
kruskal.test(vwc_percent~treatment, data = edge_vwc_24)
dunnTest(vwc_percent~treatment, data = edge_vwc_24)

kruskal.test(vwc_percent~crop, data = edge_vwc_24)
dunnTest(vwc_percent~crop, data = edge_vwc_24)

kruskal.test(vwc_percent~treatment, data = subset(edge_vwc_24, crop == "AS"))
dunnTest(vwc_percent~treatment, data = subset(edge_vwc_24, crop == "AS"))

kruskal.test(vwc_percent~treatment, data = subset(edge_vwc_24, crop == "DB"))
dunnTest(vwc_percent~treatment, data = subset(edge_vwc_24, crop == "DB"))

kruskal.test(vwc_percent~treatment, data = subset(edge_vwc_24, crop == "FC"))
dunnTest(vwc_percent~treatment, data = subset(edge_vwc_24, crop == "FC"))

#LMM: these really don't look normally distributed
model <- lmer(vwc_percent ~ treatment*crop + (1 | sample_date/block), data = edge_vwc_24)
AIC(model)
summary(model)

#extract random effects and residual values
re <- ranef(model)
resid <- augment(model)

#generate qqplot
plot(re)

#generate plot of fitted vs. residual values
ggplot(resid, aes(x = .fitted, y = .resid)) + geom_point() + stat_smooth(se = F)

#ranked likelihood test
ranova(model)

emmeans(model, pairwise ~ crop)

```


### Unclear what is happening here

If I need to go forward with weekly analysis, then I would need to do Tukey HSD tests
```{r}
test <- soil_temp_day %>%
        group_by(ID) %>%
        summarize(count = n())

summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "25")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "26")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "27")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "28")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "29")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "30")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "31")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "35")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "36")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "37")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "38")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2023" & week == "39")))

```

If I need to go forward with weekly analysis, then I would need to do Tukey HSD tests
```{r}
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "27")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "28")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "29")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "30")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "32")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "33")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "34")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "35")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "36")))
summary(aov(sqrt_vwc ~ treatment*crop, subset(soil_vwc, year == "2024" & week == "39")))

```




##Extra code from when I was being more aggressive about removing potential outliers

```{r}

# now I'm interested in samples that were very different from the others taken in the plot the same day
vwc_range <- soil_vwc %>% 
             group_by(sample_date, bed_location, block, plot) %>%
             summarize(max_vwc = max(vwc_percent, na.rm = TRUE),
                       min_vwc = min(vwc_percent, na.rm = TRUE),
                       range_vwc = max_vwc - min_vwc) %>%
             ungroup()

hist(vwc_range$range_vwc)

out_range <- subset(vwc_range, range_vwc > 10)

# I checked all the samples >11, and then went back through the ones I thought I wanted to replace with NA and deleted several that, after working through more, looked like in the range of normal
subset(soil_vwc, sample_date == "2024-09-25" & plot == "F" & block == "4")
```

```{r}
# This point was much lower than the other measurements (28-34%) 
soil_vwc$vwc_percent[soil_vwc$sample_date == "2023-06-28" & 
                              soil_vwc$plot == "B" & 
                              soil_vwc$block == "2" & 
                              soil_vwc$vwc_percent == 10.6] <- NA

# This point was much lower than the other measurements (23-26%) 
soil_vwc$vwc_percent[soil_vwc$sample_date == "2023-06-28" & 
                              soil_vwc$plot == "G" & 
                              soil_vwc$block == "2" & 
                              soil_vwc$vwc_percent == 11.1] <- NA

# This point was much lower than the other measurements (20-30%)
soil_vwc$vwc_percent[soil_vwc$sample_date == "2023-07-13" & 
                              soil_vwc$plot == "I" & 
                              soil_vwc$block == "4" & 
                              soil_vwc$vwc_percent == 8.0] <- NA

# This point was much lower than the other measurements in same bed location (24-31%)
soil_vwc$vwc_percent[soil_vwc$sample_date == "2023-08-30" & 
                              soil_vwc$plot == "E" & 
                              soil_vwc$block == "1" & 
                              soil_vwc$vwc_percent == 9.0] <- NA

# This point was much lower than the other measurements (12-22%)
soil_vwc$vwc_percent[soil_vwc$sample_date == "2023-09-14" & 
                              soil_vwc$plot == "H" & 
                              soil_vwc$block == "2" & 
                              soil_vwc$vwc_percent == 5.5] <- NA

# This point was much lower than the other measurements (15-25%)
soil_vwc$vwc_percent[soil_vwc$sample_date == "2023-09-14" & 
                              soil_vwc$plot == "C" & 
                              soil_vwc$block == "2" & 
                              soil_vwc$vwc_percent == 4.0] <- NA

# This point was much lower than the other measurements (38-39%)
soil_vwc$vwc_percent[soil_vwc$sample_date == "2024-08-28" & 
                              soil_vwc$plot == "C" & 
                              soil_vwc$block == "1" & 
                              soil_vwc$vwc_percent == 20.7] <- NA

# This point was much higher than the other measurements(18)
soil_vwc$vwc_percent[soil_vwc$sample_date == "2024-09-04" & 
                              soil_vwc$plot == "D" & 
                              soil_vwc$block == "4" & 
                              soil_vwc$vwc_percent == 34.0] <- NA

# This point was much higher than the other measurements
soil_vwc$vwc_percent[soil_vwc$sample_date == "2024-09-25" & 
                              soil_vwc$plot == "I" & 
                              soil_vwc$block == "4" & 
                              soil_vwc$vwc_percent == 35.3] <- NA

# This point was much higher than other measurements (12%)
soil_vwc$vwc_percent[soil_vwc$sample_date == "2024-09-25" & 
                              soil_vwc$plot == "B" & 
                              soil_vwc$block == "4" & 
                              soil_vwc$vwc_percent == 27.2] <- NA

# This point was much higher than other measurements (18-22%)
soil_vwc$vwc_percent[soil_vwc$sample_date == "2024-09-25" & 
                              soil_vwc$plot == "A" & 
                              soil_vwc$block == "2" & 
                              soil_vwc$vwc_percent == 32.9] <- NA

# This point was much lower than other measurements (14-18%)
soil_vwc$vwc_percent[soil_vwc$sample_date == "2024-09-25" & 
                              soil_vwc$plot == "F" & 
                              soil_vwc$block == "4" & 
                              soil_vwc$vwc_percent == 7.0] <- NA
             
```

```{r}
# from soil moisture outlier id. Combinations from out_range table that I checked but didn't take any action on.

#I didn't mark several potential outliers as NA because while the total range was quite high, the measurements taken in the plot were more spread out (i.e., it wasn't just the one low or high point)
# sample_date == "2023-06-22" & plot == "B" & block == "4"
# sample_date == "2023-06-22" & plot == "C" & block == "1"
# sample_date == "2023-06-22" & plot == "C" & block == "3"
# sample_date == "2023-06-28" & plot == "A" & block == "4"
# sample_date == "2023-06-28" & plot == "C" & block == "3"
# sample_date == "2023-06-28" & plot == "C" & block == "4"
# sample_date == "2023-06-28" & plot == "D" & block == "1"
# sample_date == "2023-06-28" & plot == "F" & block == "4"
# sample_date == "2023-06-28" & plot == "H" & block == "2"
# sample_date == "2023-07-04" & plot == "H" & block == "3"
# sample_date == "2023-07-26" & plot == "A" & block == "3"
# sample_date == "2023-07-26" & plot == "B" & block == "2"
# sample_date == "2023-07-26" & plot == "B" & block == "4"
# sample_date == "2023-07-26" & plot == "G" & block == "3"
# sample_date == "2023-07-26" & plot == "G" & block == "4"
# sample_date == "2023-07-26" & plot == "I" & block == "3"
# sample_date == "2023-07-31" & plot == "G" & block == "3"
# sample_date == "2023-08-30" & plot == "C" & block == "2"
# sample_date == "2023-08-30" & plot == "I" & block == "4"
# sample_date == "2023-09-06" & plot == "C" & block == "4"
# sample_date == "2023-09-06" & plot == "E" & block == "1"
# sample_date == "2023-09-06" & plot == "G" & block == "3"
# sample_date == "2023-09-14" & plot == "C" & block == "4"
# sample_date == "2023-09-14" & plot == "G" & block == "3"
# sample_date == "2023-09-27" & plot == "A" & block == "1"
# sample_date == "2023-09-27" & plot == "C" & block == "2"
# sample_date == "2023-09-27" & plot == "D" & block == "1"
# sample_date == "2023-09-27" & plot == "I" & block == "3"
# sample_date == "2023-09-27" & plot == "I" & block == "4"

# sample_date == "2024-07-01" & plot == "A" & block == "3"
# sample_date == "2024-07-01" & plot == "C" & block == "2"
# sample_date == "2024-07-01" & plot == "E" & block == "1"
# sample_date == "2024-07-01" & plot == "F" & block == "2"
# sample_date == "2024-07-01" & plot == "G" & block == "2"
# sample_date == "2024-07-12" & plot == "A" & block == "3"
# sample_date == "2024-07-12" & plot == "B" & block == "4"
# sample_date == "2024-07-12" & plot == "E" & block == "1"
# sample_date == "2024-07-12" & plot == "F" & block == "2"
# sample_date == "2024-07-12" & plot == "F" & block == "3"
# sample_date == "2024-07-12" & plot == "G" & block == "4"
# sample_date == "2024-07-16" & plot == "C" & block == "2"
# sample_date == "2024-07-16" & plot == "E" & block == "1"
# sample_date == "2024-07-16" & plot == "G" & block == "3"
# sample_date == "2024-07-24" & plot == "C" & block == "1"
# sample_date == "2024-07-24" & plot == "I" & block == "4"
# sample_date == "2024-08-08" & plot == "D" & block == "1"
# sample_date == "2024-08-08" & plot == "E" & block == "1"
# sample_date == "2024-08-08" & plot == "G" & block == "3"
# sample_date == "2024-08-12" & plot == "B" & block == "4"
# sample_date == "2024-08-12" & plot == "I" & block == "1"
# sample_date == "2024-08-12" & plot == "I" & block == "2"
# sample_date == "2024-08-23" & plot == "D" & block == "1"
# sample_date == "2024-08-23" & plot == "E" & block == "1"
# sample_date == "2024-08-28" & plot == "F" & block == "4"
# sample_date == "2024-08-28" & plot == "I" & block == "3"
# sample_date == "2024-09-04" & plot == "A" & block == "2"
# sample_date == "2024-09-04" & plot == "F" & block == "3"
# sample_date == "2024-09-04" & plot == "G" & block == "1"
# sample_date == "2024-09-04" & plot == "G" & block == "3"
# sample_date == "2024-09-04" & plot == "H" & block == "1"
# sample_date == "2024-09-25" & plot == "D" & block == "1"


#conflicted about these
# sample_date == "2023-06-28" & plot == "D" & block == "3
# sample_date == "2023-06-28" & plot == "E" & block == "3"
# sample_date == "2023-08-30" & plot == "B" & block == "3"
# sample_date == "2023-09-14" & plot == "B" & block == "3"
# sample_date == "2023-09-20" & plot == "B" & block == "3"
# sample_date == "2023-09-20" & plot == "I" & block == "4"
# sample_date == "2024-08-28" & plot == "I" & block == "2"
# sample_date == "2024-07-01" & plot == "C" & block == "4"
# sample_date == "2024-08-08" & plot == "B" & block == "4"
# sample_date == "2024-08-08" & plot == "D" & block == "1"
# sample_date == "2024-07-01" & plot == "G" & block == "2"
# sample_date == "2024-07-12" & plot == "G" & block == "1"
# sample_date == "2024-07-24" & plot == "A" & block == "2"
# sample_date == "2024-07-24" & plot == "B" & block == "2"
# sample_date == "2024-07-24" & plot == "C" & block == "2"
# sample_date == "2024-08-23" & plot == "D" & block == "3"
# sample_date == "2024-08-28" & plot == "D" & block == "1"
# sample_date == "2024-09-25" & plot == "I" & block == "3"

```

